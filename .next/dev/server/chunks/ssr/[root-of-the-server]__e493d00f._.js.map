{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/components/ThoughtMessage.tsx"],"sourcesContent":["import { Separator } from \"./ui/separator\";\n\ntype ThoughtMessageProps = {\n  thought: string;\n}\n\nexport const ThoughtMessage = (props: ThoughtMessageProps) => {\n  return (\n    <div>\n      <span className=\"italic text-sm px-2 py-1 bg-secondary rounded-lg\">\n        AI thought:\n      </span>\n      <div className=\"p-4 relative rounded text-muted-foreground text-sm flex\">\n        <Separator\n          orientation=\"vertical\"\n          className=\"absolute left-0 top-4 h-[calc(100%-2rem)] w-[3px]\"\n        />\n        <p className=\"flex-1 whitespace-pre-line\">{props.thought.trim()}</p>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;;;AAMO,MAAM,iBAAiB,CAAC;IAC7B,qBACE,8OAAC;;0BACC,8OAAC;gBAAK,WAAU;0BAAmD;;;;;;0BAGnE,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,2IAAS;wBACR,aAAY;wBACZ,WAAU;;;;;;kCAEZ,8OAAC;wBAAE,WAAU;kCAA8B,MAAM,OAAO,CAAC,IAAI;;;;;;;;;;;;;;;;;;AAIrE"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/components/ChatMessage.tsx"],"sourcesContent":["import ReactMarkdown from \"react-markdown\";\nimport { ThoughtMessage } from \"./ThoughtMessage\";\n\ninterface ChatMessageProps {\n  role: \"user\" | \"assistant\";\n  content: string;\n  thought?: string;\n}\n\nexport const ChatMessage = (props: ChatMessageProps) => {\n  const isAssistant = props.role === \"assistant\";\n\n  return (\n    <>\n      {!!props.thought && <ThoughtMessage thought={props.thought} />}\n\n      <div\n        className={`flex items-start gap-4 ${\n          isAssistant ? \"flex-row\" : \"flex-row-reverse\"\n        }`}\n      >\n        <div\n          className={`rounded-lg p-4 max-w-[80%] ${\n            props.role === \"assistant\"\n              ? \"bg-secondary\"\n              : \"bg-primary text-primary-foreground\"\n          }`}\n        >\n          <ReactMarkdown\n            className={isAssistant ? \"prose dark:prose-invert\" : \"\"}\n          >\n            {props.content.trim()}\n          </ReactMarkdown>\n        </div>\n      </div>\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;AAQO,MAAM,cAAc,CAAC;IAC1B,MAAM,cAAc,MAAM,IAAI,KAAK;IAEnC,qBACE;;YACG,CAAC,CAAC,MAAM,OAAO,kBAAI,8OAAC,+IAAc;gBAAC,SAAS,MAAM,OAAO;;;;;;0BAE1D,8OAAC;gBACC,WAAW,CAAC,uBAAuB,EACjC,cAAc,aAAa,oBAC3B;0BAEF,cAAA,8OAAC;oBACC,WAAW,CAAC,2BAA2B,EACrC,MAAM,IAAI,KAAK,cACX,iBACA,sCACJ;8BAEF,cAAA,8OAAC,mMAAa;wBACZ,WAAW,cAAc,4BAA4B;kCAEpD,MAAM,OAAO,CAAC,IAAI;;;;;;;;;;;;;;;;;;AAM/B"}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/components/ui/select.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"px-2 py-1.5 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute right-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAAA;AAAA;AAEA;;;;;;AAEA,MAAM,SAAS,0KAAoB;AAEnC,MAAM,cAAc,2KAAqB;AAEzC,MAAM,cAAc,2KAAqB;AAEzC,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,6KAAuB;QACtB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,kUACA;QAED,GAAG,KAAK;;YAER;0BACD,8OAAC,0KAAoB;gBAAC,OAAO;0BAC3B,cAAA,8OAAC,mOAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAI7B,cAAc,WAAW,GAAG,6KAAuB,CAAC,WAAW;AAE/D,MAAM,qCAAuB,mNAAgB,CAG3C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,oLAA8B;QAC7B,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,6NAAS;YAAC,WAAU;;;;;;;;;;;AAGzB,qBAAqB,WAAW,GAAG,oLAA8B,CAAC,WAAW;AAE7E,MAAM,uCAAyB,mNAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,sLAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,mOAAW;YAAC,WAAU;;;;;;;;;;;AAG3B,uBAAuB,WAAW,GAChC,sLAAgC,CAAC,WAAW;AAE9C,MAAM,8BAAgB,mNAAgB,CAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACzD,8OAAC,4KAAsB;kBACrB,cAAA,8OAAC,6KAAuB;YACtB,KAAK;YACL,WAAW,IAAA,kHAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACT,GAAG,KAAK;;8BAET,8OAAC;;;;;8BACD,8OAAC,8KAAwB;oBACvB,WAAW,IAAA,kHAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,8OAAC;;;;;;;;;;;;;;;;AAIP,cAAc,WAAW,GAAG,6KAAuB,CAAC,WAAW;AAE/D,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,2KAAqB,CAAC,WAAW;AAE3D,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,8OAAC,0KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,kHAAE,EACX,6NACA;QAED,GAAG,KAAK;;0BAET,8OAAC;gBAAK,WAAU;0BACd,cAAA,8OAAC,mLAA6B;8BAC5B,cAAA,8OAAC,6MAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGrB,8OAAC,8KAAwB;0BAAE;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,0KAAoB,CAAC,WAAW;AAEzD,MAAM,gCAAkB,mNAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,+KAAyB;QACxB,KAAK;QACL,WAAW,IAAA,kHAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG,+KAAyB,CAAC,WAAW"}},
    {"offset": {"line": 371, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,mNAAgB,CAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,qBACE,8OAAC;QACC,WAAW,IAAA,kHAAE,EACX,6QACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AACA,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 398, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/components/ui/shadcn-io/ai/prompt-input.tsx"],"sourcesContent":["\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { cn } from \"@/lib/utils\";\nimport type { ChatStatus } from \"ai\";\nimport { Loader2Icon, SendIcon, SquareIcon, XIcon } from \"lucide-react\";\nimport type {\n  ComponentProps,\n  HTMLAttributes,\n  KeyboardEventHandler,\n} from \"react\";\nimport { Children, useRef, useEffect } from \"react\";\n\nexport type PromptInputProps = HTMLAttributes<HTMLFormElement>;\n\nexport const PromptInput = ({ className, ...props }: PromptInputProps) => (\n  <form\n    className={cn(\n      \"w-full divide-y overflow-hidden rounded-xl border bg-background shadow-sm\",\n      className\n    )}\n    {...(props as any)}\n  />\n);\n\nexport type PromptInputTextareaProps = ComponentProps<typeof Textarea> & {\n  minHeight?: number;\n  maxHeight?: number;\n};\n\nexport const PromptInputTextarea = ({\n  onChange,\n  className,\n  placeholder = \"What would you like to know?\",\n  minHeight = 48,\n  maxHeight = 164,\n  ...props\n}: PromptInputTextareaProps) => {\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n  const handleKeyDown: KeyboardEventHandler<HTMLTextAreaElement> = (e) => {\n    if (e.key === \"Enter\") {\n      if (e.shiftKey) {\n        // Allow newline\n        return;\n      }\n\n      // Submit on Enter (without Shift)\n      e.preventDefault();\n      const form = e.currentTarget.form;\n      if (form) {\n        form.requestSubmit();\n      }\n    }\n  };\n\n  // Auto-resize textarea based on content\n  useEffect(() => {\n    const textarea = textareaRef.current;\n    if (!textarea) return;\n\n    const adjustHeight = () => {\n      textarea.style.height = \"auto\";\n      const newHeight = Math.min(\n        Math.max(textarea.scrollHeight, minHeight),\n        maxHeight\n      );\n      textarea.style.height = `${newHeight}px`;\n    };\n\n    adjustHeight();\n  }, [props.value, minHeight, maxHeight]);\n\n  return (\n    <Textarea\n      ref={textareaRef}\n      className={cn(\n        \"w-full resize-none rounded-none border-none p-3 shadow-none outline-none ring-0\",\n        \"field-sizing-content max-h-[6lh] bg-transparent dark:bg-transparent\",\n        \"focus-visible:ring-0\",\n        className\n      )}\n      name=\"message\"\n      onChange={(e) => {\n        onChange?.(e);\n      }}\n      onKeyDown={handleKeyDown}\n      placeholder={placeholder}\n      {...(props as any)}\n    />\n  );\n};\n\nexport type PromptInputToolbarProps = HTMLAttributes<HTMLDivElement>;\n\nexport const PromptInputToolbar = ({\n  className,\n  ...props\n}: PromptInputToolbarProps) => (\n  <div\n    className={cn(\"flex items-center justify-between p-1\", className)}\n    {...(props as any)}\n  />\n);\n\nexport type PromptInputToolsProps = HTMLAttributes<HTMLDivElement>;\n\nexport const PromptInputTools = ({\n  className,\n  ...props\n}: PromptInputToolsProps) => (\n  <div\n    className={cn(\n      \"flex items-center gap-1\",\n      \"[&_button:first-child]:rounded-bl-xl\",\n      className\n    )}\n    {...(props as any)}\n  />\n);\n\nexport type PromptInputButtonProps = ComponentProps<typeof Button>;\n\nexport const PromptInputButton = ({\n  variant = \"ghost\",\n  className,\n  size,\n  ...props\n}: PromptInputButtonProps) => {\n  const newSize =\n    size ?? Children.count(props.children) > 1 ? \"default\" : \"icon\";\n\n  return (\n    <Button\n      className={cn(\n        \"shrink-0 gap-1.5 rounded-lg\",\n        variant === \"ghost\" && \"text-muted-foreground\",\n        newSize === \"default\" && \"px-3\",\n        className\n      )}\n      size={newSize}\n      type=\"button\"\n      variant={variant}\n      {...(props as any)}\n    />\n  );\n};\n\nexport type PromptInputSubmitProps = ComponentProps<typeof Button> & {\n  status?: ChatStatus;\n};\n\nexport const PromptInputSubmit = ({\n  className,\n  variant = \"default\",\n  size = \"icon\",\n  status,\n  children,\n  ...props\n}: PromptInputSubmitProps) => {\n  let Icon = <SendIcon className=\"size-4\" />;\n\n  if (status === \"submitted\") {\n    Icon = <Loader2Icon className=\"size-4 animate-spin\" />;\n  } else if (status === \"streaming\") {\n    Icon = <SquareIcon className=\"size-4\" />;\n  } else if (status === \"error\") {\n    Icon = <XIcon className=\"size-4\" />;\n  }\n\n  return (\n    <Button\n      className={cn(\"gap-1.5 rounded-lg\", className)}\n      size={size}\n      type=\"submit\"\n      variant={variant}\n      {...(props as any)}\n    >\n      {children ?? Icon}\n    </Button>\n  );\n};\n\nexport type PromptInputModelSelectProps = ComponentProps<typeof Select>;\n\nexport const PromptInputModelSelect = (props: PromptInputModelSelectProps) => (\n  <Select {...(props as any)} />\n);\n\nexport type PromptInputModelSelectTriggerProps = ComponentProps<\n  typeof SelectTrigger\n>;\n\nexport const PromptInputModelSelectTrigger = ({\n  className,\n  ...props\n}: PromptInputModelSelectTriggerProps) => (\n  <SelectTrigger\n    className={cn(\n      \"border-none bg-transparent font-medium text-muted-foreground shadow-none transition-colors\",\n      'hover:bg-accent hover:text-foreground [&[aria-expanded=\"true\"]]:bg-accent [&[aria-expanded=\"true\"]]:text-foreground',\n      className\n    )}\n    {...(props as any)}\n  />\n);\n\nexport type PromptInputModelSelectContentProps = ComponentProps<\n  typeof SelectContent\n>;\n\nexport const PromptInputModelSelectContent = ({\n  className,\n  ...props\n}: PromptInputModelSelectContentProps) => (\n  <SelectContent className={cn(className)} {...(props as any)} />\n);\n\nexport type PromptInputModelSelectItemProps = ComponentProps<typeof SelectItem>;\n\nexport const PromptInputModelSelectItem = ({\n  className,\n  ...props\n}: PromptInputModelSelectItemProps) => (\n  <SelectItem className={cn(className)} {...(props as any)} />\n);\n\nexport type PromptInputModelSelectValueProps = ComponentProps<\n  typeof SelectValue\n>;\n\nexport const PromptInputModelSelectValue = ({\n  className,\n  ...props\n}: PromptInputModelSelectValueProps) => (\n  <SelectValue className={cn(className)} {...(props as any)} />\n);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 614, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/components/ui/dropdown-menu.tsx"],"sourcesContent":["import * as React from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { Check } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\n\nconst DropdownMenu = DropdownMenuPrimitive.Root;\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group;\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal;\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub;\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm font-medium outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName;\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName;\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n));\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-pointer select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n));\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName;\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n));\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n));\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => (\n  <span\n    className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n    {...props}\n  />\n);\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\";\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 788, "column": 0}, "map": {"version":3,"sources":["file:///home/danarit/Projects/private-ai-chat/app/thread/%5BthreadId%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  useLayoutEffect,\n  useRef,\n  useState,\n  type FormEventHandler,\n} from \"react\";\nimport { ChatMessage } from \"@/components/ChatMessage\";\nimport { db } from \"@/lib/dexie\";\nimport { useParams } from \"next/navigation\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport {\n  PromptInput,\n  PromptInputButton,\n  PromptInputModelSelect,\n  PromptInputModelSelectContent,\n  PromptInputModelSelectItem,\n  PromptInputModelSelectTrigger,\n  PromptInputModelSelectValue,\n  PromptInputSubmit,\n  PromptInputTextarea,\n  PromptInputToolbar,\n  PromptInputTools,\n} from \"@/components/ui/shadcn-io/ai/prompt-input\";\nimport { Paperclip, X, Menu, Settings } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useSidebar } from \"@/components/ui/sidebar\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\n// Add API URL constants (using Next.js env vars)\nconst RAG_URL = process.env.NEXT_PUBLIC_RAG_URL || \"http://localhost:5003\";\nconst CHAT_URL = process.env.NEXT_PUBLIC_CHAT_URL || \"http://localhost:5004\";\n\nexport default function ChatPage() {\n  const [messageInput, setMessageInput] = useState(\"\");\n  const [streamedMessage, setStreamedMessage] = useState(\"\");\n  const [selectedModel, setSelectedModel] = useState(\"mistral:7b\");\n  const [availableModels, setAvailableModels] = useState<string[]>([]);\n  const [status, setStatus] = useState<\n    \"submitted\" | \"streaming\" | \"ready\" | \"error\"\n  >(\"ready\");\n  const [attachments, setAttachments] = useState<File[]>([]);\n  const [isScrolled, setIsScrolled] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const scrollToBottomRef = useRef<HTMLDivElement>(null);\n  const mainRef = useRef<HTMLDivElement>(null);\n\n  const params = useParams();\n  const { toggleSidebar } = useSidebar();\n\n  const threadId = params.threadId as string;\n\n  const messages = useLiveQuery(\n    () => db.getMessagesForThread(threadId),\n    [threadId]\n  );\n\n  // Fetch available Ollama models\n  useLayoutEffect(() => {\n    const fetchModels = async () => {\n      try {\n        const response = await fetch(`${CHAT_URL}/models`);\n        if (!response.ok) {\n          throw new Error(`Server returned ${response.status}`);\n        }\n        const data = await response.json();\n        if (data.models && Array.isArray(data.models)) {\n          const modelNames = data.models.map(\n            (model: { name: string }) => model.name\n          );\n          if (modelNames.length > 0) {\n            setAvailableModels(modelNames);\n            setSelectedModel(modelNames[0]);\n          } else {\n            setAvailableModels([\"mistral:7b\"]);\n          }\n        } else {\n          setAvailableModels([\"mistral:7b\"]);\n        }\n      } catch (error) {\n        console.warn(\"Failed to fetch models (backend may be offline):\", error);\n        setAvailableModels([\"mistral:7b\"]);\n      }\n    };\n\n    fetchModels();\n  }, []);\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    setAttachments((prev) => [...prev, ...files]);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  const handleRemoveAttachment = (index: number) => {\n    setAttachments((prev) => prev.filter((_, i) => i !== index));\n  };\n\n  const handleSubmit: FormEventHandler<HTMLFormElement> = async (event) => {\n    event.preventDefault();\n    if (!messageInput.trim()) return;\n\n    setStatus(\"submitted\");\n\n    const userMessage = messageInput.trim();\n\n    await db.createMessage({\n      content: userMessage,\n      role: \"user\",\n      thought: \"\",\n      thread_id: threadId,\n    });\n\n    setMessageInput(\"\");\n    setAttachments([]);\n\n    setTimeout(() => {\n      setStatus(\"streaming\");\n    }, 200);\n\n    const modelName = selectedModel;\n\n    // Query RAG system for relevant context\n    console.log(\"ðŸ” Querying RAG system for context...\");\n    let ragContext = \"\";\n    try {\n      const ragResponse = await fetch(`${RAG_URL}/query`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ query: userMessage }),\n      });\n\n      if (ragResponse.ok) {\n        const ragData = await ragResponse.json();\n        if (ragData.has_context) {\n          ragContext = ragData.context;\n          console.log(\n            \"âœ… RAG Context retrieved:\",\n            ragData.contexts.length,\n            \"chunks\"\n          );\n        } else {\n          console.log(\"â„¹ No relevant context found in documents\");\n        }\n      } else {\n        console.warn(\"âš  RAG server unavailable, continuing without context\");\n      }\n    } catch (error) {\n      console.warn(\"âš  RAG query failed:\", error);\n      console.log(\"  Continuing without document context...\");\n    }\n\n    // Get conversation history\n    const history = await db.getMessagesForThread(threadId);\n\n    // Build system prompt with context if available\n    let systemPrompt =\n      \"Kamu adalah asisten AI yang membantu. Selalu jawab dalam Bahasa Indonesia yang sopan dan jelas. Berikan jawaban yang SINGKAT dan LANGSUNG KE INTI. Jangan memberikan penjelasan panjang kecuali diminta. Untuk pertanyaan sederhana, jawab dengan 1-2 kalimat saja.\";\n\n    if (ragContext) {\n      systemPrompt += `\\n\\nGunakan informasi berikut sebagai referensi untuk menjawab pertanyaan:\\n\\n${ragContext}\\n\\nJawab berdasarkan informasi di atas jika relevan dengan pertanyaan. Jika informasi tidak cukup atau tidak relevan, jawab berdasarkan pengetahuan umum.`;\n    }\n\n    // Build messages array with conversation history\n    const chatMessages = [\n      {\n        role: \"system\" as const,\n        content: systemPrompt,\n      },\n      ...history.map((msg) => ({\n        role: msg.role as \"user\" | \"assistant\",\n        content: msg.content,\n      })),\n      {\n        role: \"user\" as const,\n        content: userMessage,\n      },\n    ];\n\n    try {\n      // Send to backend chat server (which proxies to Ollama)\n      const response = await fetch(`${CHAT_URL}/chat`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          model: modelName,\n          messages: chatMessages,\n          stream: true,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Chat server error\");\n      }\n\n      const reader = response.body?.getReader();\n      const decoder = new TextDecoder();\n      let fullContent = \"\";\n\n      while (reader) {\n        const { done, value } = await reader.read();\n        if (done) break;\n\n        const chunk = decoder.decode(value);\n        const lines = chunk.split(\"\\n\").filter((line) => line.trim());\n\n        for (const line of lines) {\n          try {\n            const json = JSON.parse(line);\n            if (json.message?.content) {\n              fullContent += json.message.content;\n              setStreamedMessage(fullContent);\n            }\n          } catch {\n            // Skip invalid JSON\n          }\n        }\n      }\n\n      await db.createMessage({\n        content: fullContent,\n        role: \"assistant\",\n        thought: \"\",\n        thread_id: threadId,\n      });\n\n      setStreamedMessage(\"\");\n      setStatus(\"ready\");\n    } catch (error) {\n      console.error(\"âŒ Error calling Chat API:\", error);\n      setStatus(\"error\");\n      alert(\"Failed to connect to chat server\");\n    }\n  };\n\n  const handleScrollToBottom = () => {\n    scrollToBottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useLayoutEffect(() => {\n    handleScrollToBottom();\n  }, [streamedMessage, messages]);\n\n  // Handle scroll for header border visibility\n  useLayoutEffect(() => {\n    const mainElement = mainRef.current;\n    if (!mainElement) return;\n\n    const handleScroll = () => {\n      setIsScrolled(mainElement.scrollTop > 0);\n    };\n\n    mainElement.addEventListener(\"scroll\", handleScroll);\n    return () => mainElement.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  return (\n    <div\n      className=\"flex flex-col flex-1\"\n      style={{ height: \"calc(var(--vh, 1vh) * 100)\" }}\n    >\n      <main ref={mainRef} className=\"flex-1 overflow-auto w-full\">\n        <header\n          className={`sticky top-0 flex items-center px-4 h-16 z-10 transition-colors bg-background 2xl:bg-transparent 2xl:border-none ${\n            isScrolled ? \"border-b\" : \"\"\n          }`}\n        >\n          <div className=\"flex items-center gap-2 lg:gap-2 w-full lg:w-auto\">\n            {/* Mobile Hamburger Button */}\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={toggleSidebar}\n              className=\"lg:hidden\"\n            >\n              <Menu className=\"h-6 w-6\" />\n            </Button>\n            <h1 className=\"text-xl font-bold absolute left-1/2 -translate-x-1/2 lg:static lg:translate-x-0\">\n              AI Chat Dashboard\n            </h1>\n          </div>\n\n          {/* Settings Dropdown */}\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                className=\"ml-auto lg:w-auto lg:px-3\"\n              >\n                <Settings className=\"h-5 w-5\" />\n                <span className=\"hidden lg:inline ml-2\">Settings</span>\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\" className=\"w-56\">\n              <DropdownMenuItem>Export Chat History</DropdownMenuItem>\n              <DropdownMenuItem>Clear Conversation</DropdownMenuItem>\n              <DropdownMenuItem>Chat Preferences</DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </header>\n        <div className=\"p-4\">\n          <div className=\"mx-auto space-y-4 pb-20 max-w-screen-md\">\n            {messages?.map((message, index) => (\n              <ChatMessage\n                key={index}\n                role={message.role}\n                content={message.content}\n                thought={message.thought}\n              />\n            ))}\n\n            {!!streamedMessage && (\n              <ChatMessage role=\"assistant\" content={streamedMessage} />\n            )}\n\n            <div ref={scrollToBottomRef}></div>\n          </div>\n        </div>\n      </main>\n      <footer className=\"p-4\">\n        <div className=\"max-w-3xl mx-auto\">\n          <PromptInput onSubmit={handleSubmit}>\n            {attachments.length > 0 && (\n              <div className=\"flex flex-wrap gap-2 p-3\">\n                {attachments.map((file, index) => (\n                  <div\n                    key={index}\n                    className=\"flex items-center gap-2 bg-muted rounded-md px-3 py-1.5 text-sm\"\n                  >\n                    <span className=\"truncate max-w-[200px]\">{file.name}</span>\n                    <button\n                      type=\"button\"\n                      onClick={() => handleRemoveAttachment(index)}\n                      className=\"hover:bg-background rounded-sm p-0.5\"\n                    >\n                      <X className=\"h-3 w-3\" />\n                    </button>\n                  </div>\n                ))}\n              </div>\n            )}\n            <PromptInputTextarea\n              onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) =>\n                setMessageInput(e.target.value)\n              }\n              value={messageInput}\n              placeholder=\"Type your message...\"\n            />\n            <PromptInputToolbar>\n              <PromptInputTools>\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  multiple\n                  onChange={handleFileSelect}\n                  className=\"hidden\"\n                />\n                <PromptInputButton\n                  type=\"button\"\n                  onClick={() => fileInputRef.current?.click()}\n                >\n                  <Paperclip className=\"h-4 w-4\" />\n                </PromptInputButton>\n                <PromptInputModelSelect\n                  onValueChange={setSelectedModel}\n                  value={selectedModel}\n                >\n                  <PromptInputModelSelectTrigger>\n                    <PromptInputModelSelectValue />\n                  </PromptInputModelSelectTrigger>\n                  <PromptInputModelSelectContent>\n                    {availableModels.map((model) => (\n                      <PromptInputModelSelectItem key={model} value={model}>\n                        {model}\n                      </PromptInputModelSelectItem>\n                    ))}\n                  </PromptInputModelSelectContent>\n                </PromptInputModelSelect>\n              </PromptInputTools>\n              <PromptInputSubmit disabled={!messageInput} status={status} />\n            </PromptInputToolbar>\n          </PromptInput>\n        </div>\n      </footer>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}